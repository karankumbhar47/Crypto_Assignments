%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \setmathfont{TeX Gyre Termes Math}
%Packages
\documentclass[10pt, a4paper]{article}
\usepackage[top=3cm, bottom=4cm, left=2cm, right=2cm]{geometry}
\usepackage{amsmath,amsthm,amsfonts,amssymb,amscd, fancyhdr, color, comment, graphicx, environ}
\usepackage{float}
\usepackage{booktabs}
\usepackage{pifont}
\usepackage{mathrsfs}
\usepackage[math-style=ISO]{unicode-math}
\usepackage{lastpage}
\usepackage[dvipsnames]{xcolor}
\usepackage[framemethod=TikZ]{mdframed}
\usepackage{enumerate}
\usepackage[shortlabels]{enumitem}
\usepackage{fancyhdr}
\usepackage{indentfirst}
\usepackage{listings}
\usepackage{sectsty}
\usepackage{thmtools}
\usepackage{shadethm}
\usepackage{hyperref}
\usepackage{setspace}
\usepackage{adjustbox}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=blue,
}
\usepackage{xcolor,colortbl}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Environment setup
\mdfsetup{skipabove=\topskip,skipbelow=\topskip}
\newrobustcmd\ExampleText{%
An \textit{inhomogeneous linear} differential equation has the form
\begin{align}
L[v ] = f,
\end{align}
where $L$ is a linear differential operator, $v$ is the dependent
variable, and $f$ is a given nonâˆ’zero function of the independent
variables alone.
}
\mdfdefinestyle{theoremstyle}{%
linecolor=black,linewidth=1pt,%
frametitlerule=true,%
frametitlebackgroundcolor=gray!20,
innertopmargin=\topskip,
}
\mdtheorem[style=theoremstyle]{Problem}{Question Number}
\setcounter{Problem}{4}
\newenvironment{Solution}{\textbf{Solution.}}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}

\lstset{style=mystyle}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fill in the appropriate information below
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}     
\newcommand\course{XXXX0000}                            % <-- course name   
\newcommand\hwnumber{0}                                 % <-- homework number
\newcommand\Information{Someone}                        % <-- personal information
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Page setup
\pagestyle{fancy}
\headheight 35pt
\lhead{\today \hspace*{4cm} Key-Breakers}
\rhead{\includegraphics[width=1.2cm]{../logo.png}}
\lfoot{}
\pagenumbering{arabic}
\cfoot{\small\thepage}
\rfoot{}
\headsep 1.2em
\renewcommand{\baselinestretch}{1.25}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Add new commands here
\renewcommand{\labelenumi}{\alph{enumi})}
\newcommand{\Z}{\mathbb Z}
\newcommand{\R}{\mathbb R}
\newcommand{\Q}{\mathbb Q}
\newcommand{\NN}{\mathbb N}
\newcommand{\PP}{\mathbb P}
\DeclareMathOperator{\Mod}{Mod} 
\renewcommand\lstlistingname{Algorithm}
\renewcommand\lstlistlistingname{Algorithms}
\def\lstlistingautorefname{Alg.}
\newtheorem*{theorem}{Theorem}
\newtheorem*{lemma}{Lemma}
\newtheorem{case}{Case}
\newcommand{\assign}{:=}
\newcommand{\infixiff}{\text{ iff }}
\newcommand{\nobracket}{}
\newcommand{\backassign}{=:}
\newcommand{\tmmathbf}[1]{\ensuremath{\boldsymbol{#1}}}
\newcommand{\tmop}[1]{\ensuremath{\operatorname{#1}}}
\newcommand{\tmtextbf}[1]{\text{{\bfseries{#1}}}}
\newcommand{\tmtextit}[1]{\text{{\itshape{#1}}}}

\newenvironment{itemizedot}{
    \begin{itemize} 
    \renewcommand{\labelitemi}{$\bullet$}
    \renewcommand{\labelitemii}{$\bullet$}
    \renewcommand{\labelitemiii}{$\bullet$}
    \renewcommand{\labelitemiv}{$\bullet$}}
    {\end{itemize}}

\catcode`\<=\active\def<{
\fontencoding{T1}\selectfont\symbol{60}\fontencoding{\encodingdefault}}
\catcode`\>=\active\def>{
\fontencoding{T1}\selectfont\symbol{62}\fontencoding{\encodingdefault}}
\catcode`\<=\active\def<{
\fontencoding{T1}\selectfont\symbol{60}\fontencoding{\encodingdefault}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Begin now!



\begin{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Start the assignment now
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%New problem
\newpage
\begin{Problem}
    A key is called involutory when $e_K = d_K$ . Let an Affine Cipher be defined over $\mathbb{Z}_m$ with key
    $K = (a, b)$.
    \begin{itemize}
        \item Prove that K is an involutory key if and only if
              \[
                  a^{-1} \mod m = a  \And
                  b(a + 1) \equiv 0 \mod m
              \]
        \item Now find all involutory keys in $\mathbb{Z}_{15}$ for the Affine Cipher
        \item Determine the number of keys in an Affine Cipher over $\mathbb{Z}_m$ for $m = 30, 100$ and $1225$.
    \end{itemize}
\end{Problem}

\begin{Solution}

    \subsection*{Part1}Let an Affine Cipher be defined over \( \mathbb{Z}_m \) with key \( K = (a, b) \). We want to prove that \( K \) is an involutory key if and only if \( a^{-1} \bmod m = a \) and \( b(a + 1) \equiv 0 \pmod{m} \).
    \subsubsection*{Proof}

    An Affine Cipher's encryption and decryption functions can be written as:
    \[e_K(x) = (ax + b) \bmod m \]
    \[ d_K(y) = a^{-1}(y - b) \bmod m \]

    For \( K \) to be involutory, applying the encryption function twice should result in the original plaintext \( x \). This implies that:
    \[ e_K(e_K(x)) \equiv x \pmod{m} \]

    Let's apply the encryption function twice:

    \[ e_K(e_K(x)) = e_K(ax + b) = a(ax + b) + b \bmod m \]
    \[ = (a^2x + ab + b) \bmod m \]

    For \( K \) to be involutory, this expression must equal \( x \) modulo \( m \):

    \[ a^2x + ab + b \equiv x \pmod{m} \]

    Since this equation must hold for all \( x \in \mathbb{Z}_m \), we can equate the coefficients of \( x \) and the constant terms separately:

    \[ a^2 \equiv 1 \pmod{m} \]
    \[ ab + b \equiv 0 \pmod{m} \]

    \subsubsection*{Step 1: Analyzing \( a^2 \equiv 1 \pmod{m} \)}

    The equation \( a^2 \equiv 1 \pmod{m} \) implies that \( a \) is a square root of 1 modulo \( m \). The solutions to this equation are:
    \[ a \equiv 1 \pmod{m} \quad \text{or} \quad a \equiv m-1 \pmod{m} \]

    Furthermore, from \( a^2 \equiv 1 \pmod{m} \), we also have:
    \[ a \equiv a^{-1} \pmod{m} \]

    This means that \( a \) must be its own inverse modulo \( m \), i.e., \( a^{-1} = a \).

    \subsubsection*{Step 2: Analyzing \( ab + b \equiv 0 \pmod{m} \)}

    We can factor the second equation as:
    \[ b(a + 1) \equiv 0 \pmod{m} \]

    This implies that \( b(a + 1) \) is divisible by \( m \). Therefore, for the equation to hold:

    \begin{itemize}
        \item If \( a + 1 \) is not divisible by \( m \), then \( b \) must be 0 modulo \( m \).
        \item If \( a + 1 \equiv 0 \pmod{m} \) (i.e., \( a \equiv m-1 \pmod{m} \)), then \( b \) can be any value in \( \mathbb{Z}_m \).
    \end{itemize}

    \subsubsection*{Conclusion}
    Combining these results, we conclude that \( K = (a, b) \) is an involutory key if and only if:
    \[ a^{-1} \equiv a \pmod{m} \quad \text{and} \quad b(a + 1) \equiv 0 \pmod{m} \]

    \pagebreak

    \subsection*{Part 2} Finding All Involutory Keys in \( \mathbb{Z}_{15} \) for the Affine Cipher

    We need to find all values of \( a \) and \( b \) such that the key \( K = (a, b) \) is involutory in \( \mathbb{Z}_{15} \). For the key \( K \) to be involutory, it must satisfy:
    \[ a^{-1} \equiv a \pmod{15} \]
    \[ b(a + 1) \equiv 0 \pmod{15} \]

    First, we determine all values of \( a \) such that:
    \[ a^2 \equiv 1 \pmod{15} \]

    This can be rewritten as:
    \[ a^2 - 1 \equiv 0 \pmod{15} \implies (a - 1)(a + 1) \equiv 0 \pmod{15} \]

    We test values in \( \mathbb{Z}_{15} \):
    \[ a = 1 \quad \text{and} \quad a = 14 \]

    These values satisfy:
    \[ 1^2 \equiv 1 \pmod{15} \quad \text{and} \quad 14^2 \equiv 196 \equiv 1 \pmod{15} \]

    Next, we find the corresponding values of \( b \) for each \( a \) such that:
    \[ b(a + 1) \equiv 0 \pmod{15} \]

    \begin{itemize}
        \item For \( a = 1 \):
              \[ b(1 + 1) = 2b \equiv 0 \pmod{15} \]
              This implies:
              \[ 2b \equiv 0 \pmod{15} \]
              The solutions are \( b = 0 \) (as \( 2b = 0 \) in \( \mathbb{Z}_{15} \)).

        \item For \( a = 14 \):
              \[ b(14 + 1) = 15b \equiv 0 \pmod{15} \]
              This is always satisfied for any \( b \in \mathbb{Z}_{15} \) because \( 15b \) is always 0 modulo 15.
    \end{itemize}

    Thus, the involutory keys in \( \mathbb{Z}_{15} \) are:

    \[ (1, 0) \quad \text{and} \quad (14, b) \text{ for all } b \in \mathbb{Z}_{15} \]

    Note that \( b = 15 \) is equivalent to \( b = 0 \) modulo 15.
    \pagebreak

    \subsection*{Part3}
    Determining the Number of Keys in an Affine Cipher over \( \mathbb{Z}_m \) for \( m = 30, 100, \text{ and } 1225 \)

    The number of keys \( (a, b) \) for an Affine Cipher over \( \mathbb{Z}_m \) is given by the product of the number of possible values for \( a \) and \( b \). Specifically:

    - \( a \) must be coprime to \( m \) (i.e., \( \gcd(a, m) = 1 \)).
    - \( b \) can be any value in \( \mathbb{Z}_m \), so there are \( m \) possible values for \( b \).

    The number of possible values for \( a \) is given by \( \phi(m) \), where \( \phi \) is the Euler's totient function.

    \begin{itemize}
        \item \textbf{For \( m = 30 \):}
              \[ \phi(30) = \phi(2 \cdot 3 \cdot 5) = (2-1)(3-1)(5-1) = 1 \cdot 2 \cdot 4 = 8 \]
              Thus, the number of keys is:
              \[ \phi(30) \times 30 = 8 \times 30 = 240 \]

        \item \textbf{For \( m = 100 \):}
              \[ \phi(100) = \phi(2^2 \cdot 5^2) = (2^2 - 2^1)(5^2 - 5^1) = 2 \cdot 20 = 40 \]
              Thus, the number of keys is:
              \[ \phi(100) \times 100 = 40 \times 100 = 4000 \]

        \item \textbf{For \( m = 1225 \):}
              \[ \phi(1225) = \phi(5^2 \cdot 7^2) = (5^2 - 5^1)(7^2 - 7^1) = 20 \cdot 42 = 840 \]
              Thus, the number of keys is:
              \[ \phi(1225) \times 1225 = 840 \times 1225 = 1029000 \]
    \end{itemize}

    To find $\phi$ function values use pytyhon code from \texttt{eulerTotient.py} 

\end{Solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Complete the assignment now
\end{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%