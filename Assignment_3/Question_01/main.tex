%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \setmathfont{TeX Gyre Termes Math}
%Packages
\documentclass[10pt, a4paper]{article}
\usepackage[top=3cm, bottom=4cm, left=2cm, right=2cm]{geometry}
\usepackage{amsmath,amsthm,amsfonts,amssymb,amscd, fancyhdr, color, comment, graphicx, environ}
\usepackage{float}
\usepackage{booktabs}
\usepackage{pifont}
\usepackage{mathrsfs}
\usepackage[math-style=ISO]{unicode-math}
\usepackage{lastpage}
\usepackage[dvipsnames]{xcolor}
\usepackage[framemethod=TikZ]{mdframed}
\usepackage{enumerate}
\usepackage[shortlabels]{enumitem}
\usepackage{fancyhdr}
\usepackage{indentfirst}
\usepackage{listings}
\usepackage{sectsty}
\usepackage{thmtools}
\usepackage{shadethm}
\usepackage{hyperref}
\usepackage{setspace}
\usepackage{adjustbox}
\hypersetup{
	colorlinks=true,
	linkcolor=blue,
	filecolor=magenta,
	urlcolor=blue,
}
\usepackage{xcolor,colortbl}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Environment setup
\mdfsetup{skipabove=\topskip,skipbelow=\topskip}
\newrobustcmd\ExampleText{%
	An \textit{inhomogeneous linear} differential equation has the form
	\begin{align}
		L[v ] = f,
	\end{align}
	where $L$ is a linear differential operator, $v$ is the dependent
	variable, and $f$ is a given nonâˆ’zero function of the independent
	variables alone.
}
\mdfdefinestyle{theoremstyle}{%
	linecolor=black,linewidth=1pt,%
	frametitlerule=true,%
	frametitlebackgroundcolor=gray!20,
	innertopmargin=\topskip,
}
\mdtheorem[style=theoremstyle]{Problem}{Question Number}
\setcounter{Problem}{0}
\newenvironment{Solution}{\textbf{Solution.}}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
	backgroundcolor=\color{backcolour},
	commentstyle=\color{codegreen},
	keywordstyle=\color{magenta},
	numberstyle=\tiny\color{codegray},
	stringstyle=\color{codepurple},
	basicstyle=\ttfamily\footnotesize,
	breakatwhitespace=false,
	breaklines=true,
	captionpos=b,
	keepspaces=true,
	numbers=left,
	numbersep=5pt,
	showspaces=false,
	showstringspaces=false,
	showtabs=false,
	tabsize=2
}

\lstset{style=mystyle}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fill in the appropriate information below
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand\course{XXXX0000}                            % <-- course name   
\newcommand\hwnumber{0}                                 % <-- homework number
\newcommand\Information{Someone}                        % <-- personal information
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Page setup
\pagestyle{fancy}
\headheight 35pt
\lhead{\today \hspace*{4cm} Key-Breakers}
\rhead{\includegraphics[width=1.2cm]{../logo.png}}
\lfoot{}
\pagenumbering{arabic}
\cfoot{\small\thepage}
\rfoot{}
\headsep 1.2em
\renewcommand{\baselinestretch}{1.25}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Add new commands here
\renewcommand{\labelenumi}{\alph{enumi})}
\newcommand{\Z}{\mathbb Z}
\newcommand{\R}{\mathbb R}
\newcommand{\Q}{\mathbb Q}
\newcommand{\NN}{\mathbb N}
\newcommand{\PP}{\mathbb P}
\DeclareMathOperator{\Mod}{Mod}
\renewcommand\lstlistingname{Algorithm}
\renewcommand\lstlistlistingname{Algorithms}
\def\lstlistingautorefname{Alg.}
\newtheorem*{theorem}{Theorem}
\newtheorem*{lemma}{Lemma}
\newtheorem{case}{Case}
\newcommand{\assign}{:=}
\newcommand{\infixiff}{\text{ iff }}
\newcommand{\nobracket}{}
\newcommand{\backassign}{=:}
\newcommand{\tmmathbf}[1]{\ensuremath{\boldsymbol{#1}}}
\newcommand{\tmop}[1]{\ensuremath{\operatorname{#1}}}
\newcommand{\tmtextbf}[1]{\text{{\bfseries{#1}}}}
\newcommand{\tmtextit}[1]{\text{{\itshape{#1}}}}

\newenvironment{itemizedot}{
	\begin{itemize}
		\renewcommand{\labelitemi}{$\bullet$}
		\renewcommand{\labelitemii}{$\bullet$}
		\renewcommand{\labelitemiii}{$\bullet$}
		\renewcommand{\labelitemiv}{$\bullet$}}
		{\end{itemize}}

\catcode`\<=\active\def<{
\fontencoding{T1}\selectfont\symbol{60}\fontencoding{\encodingdefault}}
\catcode`\>=\active\def>{
\fontencoding{T1}\selectfont\symbol{62}\fontencoding{\encodingdefault}}
\catcode`\<=\active\def<{
\fontencoding{T1}\selectfont\symbol{60}\fontencoding{\encodingdefault}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Begin now!



\begin{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Start the assignment now
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%New problem
\newpage
\begin{Problem}
	Encode your name (including spaces) in the AES state matrix as shown in class.
	\begin{itemize}
		\item If your name has more than 14 characters (including spaces), use only the first 12 characters.
		\item Pad the rest of the state to make it 16 bytes.
		\item  For padding use (and mention in the answer) any scheme from \\ \url{https://en.wikipedia.org/wiki/Padding_(cryptography)}.
		\item Next apply the \texttt{ShiftRows} operation on the state.
		\item Next apply the \texttt{SubBytes} operation.
		\item Show the state matrix after every operation.
	\end{itemize}
\end{Problem}

\begin{Solution}

	\begin{enumerate}[label=\textbf{Step \arabic*:}]
		\item \textbf{Encode the Name}

		      The name used is \texttt{"Karan Sunil Kumbhar"}. As it contains 19 characters, we take only the first 12 characters:
		      \[ \text{Name: } \texttt{"KARAN SUNIL "} \]

		\item \textbf{Zero Padding to 16 Bytes}

		      Zero padding is applied to make the length of the string 16 bytes. The padded string will be:
		      \[ \text{Padded String: } \texttt{"KARAN SUNIL K\texttt{\char`00}\char`00\char`00\char`00"} \]

		      In hexadecimal, this looks like:
		      \[
			      \text{State 1 : }
			      \renewcommand{\arraystretch}{1.5}
			      \setlength{\arrayrulewidth}{0.6mm}
			      \setlength{\tabcolsep}{0.5em}
			      \begin{array}{|>{\centering\arraybackslash}m{2em}|>{\centering\arraybackslash}m{2em}|>{\centering\arraybackslash}m{2em}|>{\centering\arraybackslash}m{2em}|}
				      \hline
				      \text{0x4B} & \text{0x4E} & \text{0x4E} & \text{0x00} \\
				      \hline
				      \text{0x41} & \text{0x20} & \text{0x49} & \text{0x00} \\
				      \hline
				      \text{0x52} & \text{0x53} & \text{0x4C} & \text{0x00} \\
				      \hline
				      \text{0x41} & \text{0x55} & \text{0x20} & \text{0x00} \\
				      \hline
			      \end{array}
		      \]



		      \pagebreak
		\item \textbf{Apply ShiftRows Operation}

		      The \textbf{ShiftRows} operation involves cyclically shifting the rows of the matrix:

		      \[
			      \text{State 2 : }
			      \renewcommand{\arraystretch}{1.5}
			      \setlength{\arrayrulewidth}{0.6mm}
			      \setlength{\tabcolsep}{0.5em}
			      \begin{array}{|>{\centering\arraybackslash}m{2em}|>{\centering\arraybackslash}m{2em}|>{\centering\arraybackslash}m{2em}|>{\centering\arraybackslash}m{2em}|}
				      \hline
				      \text{0x4B} & \text{0x4E} & \text{0x4E} & \text{0x00} \\
				      \hline
				      \text{0x20} & \text{0x49} & \text{0x00} & \text{0x41} \\
				      \hline
				      \text{0x4C} & \text{0x00} & \text{0x52} & \text{0x53} \\
				      \hline
				      \text{0x00} & \text{0x41} & \text{0x55} & \text{0x20} \\
				      \hline
			      \end{array}
		      \]


		\item \textbf{Apply SubBytes Operation}

		      The \textbf{SubBytes} operation involves substituting each byte in the state matrix using the AES S-Box. Here are a few substitutions:
		      \begin{itemize}
			      \item \(\text{0x4B} \rightarrow \text{0xB3}\)
			      \item \(\text{0x41} \rightarrow \text{0x83}\)
			      \item \(\text{0x52} \rightarrow \text{0x00}\)
			      \item \(\text{0x4E} \rightarrow \text{0x2F}\)
			      \item \(\text{0x20} \rightarrow \text{0xB7}\)
			      \item \(\text{0x53} \rightarrow \text{0xED}\)
			      \item \(\text{0x55} \rightarrow \text{0xFC}\)
			      \item \(\text{0x49} \rightarrow \text{0x3B}\)
			      \item \(\text{0x4C} \rightarrow \text{0x29}\)
			      \item \(\text{0x00} \rightarrow \text{0x63}\)
		      \end{itemize}

		      After applying \textbf{SubBytes}, the state matrix becomes:
		      \[
			      \text{State 3 : }
			      \renewcommand{\arraystretch}{1.5}
			      \setlength{\arrayrulewidth}{0.6mm}
			      \setlength{\tabcolsep}{0.5em}
			      \begin{array}{|>{\centering\arraybackslash}m{2em}|>{\centering\arraybackslash}m{2em}|>{\centering\arraybackslash}m{2em}|>{\centering\arraybackslash}m{2em}|}
				      \hline
				      \text{0xB3} & \text{0x2F} & \text{0x2F} & \text{0x63} \\
				      \hline
				      \text{0xB7} & \text{0x3B} & \text{0x63} & \text{0x83} \\
				      \hline
				      \text{0x29} & \text{0x63} & \text{0x00} & \text{0xED} \\
				      \hline
				      \text{0x63} & \text{0x83} & \text{0xFC} & \text{0xB7} \\
				      \hline
			      \end{array}
		      \]

		      After encoding the name, padding, and applying the AES operations
		      (ShiftRows and SubBytes), the final state matrix is shown above.

	\end{enumerate}

\end{Solution}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Complete the assignment now
\end{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
